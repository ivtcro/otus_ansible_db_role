language: python
python:
- '2.7'
install:
- pip install ansible==2.5.0 molecule==2.12.1 testinfra==1.7.1 apache-libcloud
env:
  matrix:
  - GCE_CREDENTIALS_FILE="$(pwd)/Infra-be2fec3bae25.json"
  global:
  - secure: flBBXWlUrUu2Fp72u4sgL8NRuOXVgXvciddbh6a68TIBXmJgBw3BDRq5IbxtGaIs9LEjw4PodaSagBZAgwdYbSP6+vpFLgc+K0KAIyQrrjb0gNTsb/YHMugxuysZaoQU3izDExv+wR3AjDw+4yoO5ZhFHsxWzhjNHF/4k0hQJdvrEuRzbBTyOaGMp6H7a2eqBUtmKF8APx7cWI3gyW3jbdns9A9cCMpMkySVcPSBnJuv9q9zSHNsey9BnzKeYLJTH2uYusd/hOLOtPLfRuif2fuWMK2IoxcVuHM1YTl1FgoE7KXZdXQdJ7CrwHjB3UtpsvzwE7Bev8/JjoOqbZgbOf/Gg1tPEwk2DJPAxzuhd+Ad/nw9JQ6Ea2qFL3flNdXxyQ/S936sRsxvP6Q68UCYYtSBQ9yUix7aGlSsa1APgcgQ/eblnHo9r/cNhvVz+J2DRsoUiuHTgU/HmUCTFu74anzgllz9L5Yj2u8Q0RMxiMKoxe5Bz9cemPylHNQlLZYbTkl5DensuqRZ6f107SjiZg6zHx5YI5FN+0BFUu3MYCU1f0u762tTlf8uhy+5coYba6U6NI540ft+4npXgo9p0C1w8/gyKIcrSlhZe2TrwUXQSyp//h655hLRC5ZY8Qhnc0Qsbhp2oP1VHO28SOkyy3MRFgfaYJLiE8yUqSIKkPI=
  - secure: sQF8LrW2YBgVPYDd9uY3ioV3DFG99hdwt7CehqqOnLZkBrj7b4UkFJU13D/ugtqVcqw5Kc6ApXitkHoxxNsn2/GG/0rBj7OIzUpsH6KGVCvaEalJ5+I6MkwwxOqa1xao4D4W2RG+vz5EABK9rDz9/Bk5oesv1Y/udbaLyNuU3afi+I1JLeUJ0AoARCISxDD3jwGpCEno5O43aNY5Qzg7YzZBpbb8xtkqg00099qOnw1He1xt0dZnrrTAuqB6Z5U542f1htrnALJX4wKJSjisdYZUUAv6LZhtlZr1F3pOmOyMgYFoV4h61qI/hFiog5+TKGekIfoMYQX/waMVSUfGqL8Yjr3RFE2UhRJ/1E+K4iu6LZf0qy2ZCOWAAaAXqoPO7WIJ7xmianD3VNRpTtdPrCMaSS6gbc/8WDl68BccKGPsC7/XBwpHS3pnycAv20tCw7zdTrQwvpXtc2T0ZTAhldGBO1SfcIVevqZd1ZCN1WCfwjUMQR53dGqtKpKy8bLLaZu5ATs/zCk5vHKY4dlUGd6CJQP40O7H3hVwWNmPLU+Wj4/6WIZ7rH1Xcb4AEHCD4xjVmjOUx2L5H0SyokuB0kIDniFxkCfQo8NMSY5Mpnw7kss8VJ7tPVGZRQvAQBZD2VMcQsV7fOFLP7QO/Q9CHOf15WzCGvDiwoCyVIR3CCI=
  - secure: AU32Bwnn/4DtRYdM+7cMZ6jrqyMFrYF01aXegeJrJwSfdJiJA5ORVBrzjqYz7J9yDr2i8JGGBJPlDjSbv4hrvItoXlADulVv/7CFDN3rZQYCBHc3tburxYjw2IALwCXeKKq8F/EfaEcFII8zQLATm3QC+rabfOzVwMJXV4cXeQ2Bc7M3k3atcwvxZTZggoyF6FMRWNrJ0QbH6L0uQ/IKL6f47+VsIMFd6PLpkSybOHjAnWLPBS+wZ6XUBbnecz5OvCoftYy+ZP+w+SSFy/j4onanxY2ly/QWNwwpB3Iedjiz/YyaE6Pfr+oGFdObxeKMKIm9BPd3p/ucE/B4KoBHdaFxTv8jrPPeFklyZj7tAozniYD0sx6nSHp5cj1x/tSzWGDs7Bi9IxrVvXMF9aV+ttHlbCIA5NRF7kXHh6B4m/NyBCIFq8QX+41l4P9ufOrv/sIg24wRZ/sNDI+XxKEEOcvp41LRSsV7N6s+xx54Uyt9pb2/E60baiZa/AsrHxgoLMn6G5cltXdWG9xr4jBM2pZfN2OuPimaPm//4uIu0zTYm/IYe0wlDuLcMOPiWFaGWioFUtWWYRXp33ijRhjkfjR8khqBdwjb/HZrOjb1IYaoPwYrCIcijHkLmH+dNJ6g2CEExju593NQdQZ+4NJ3lvrAOR8J1+r34rC1AGDr7jU=
notifications:
  slack:
    secure: GtTmhAWqNPI8kPo1QxEauDfu6I59fhDsqX+hXptqUR7HZk2ylk8wNVL9NCHXQ6bpsZUXV+2jBL4ZtsoOtmPGysL/vi2o1dk7C3dYVGDYkW+Xe8ngXSqCMEPWXfJggbOC/EeBvcvAKVO1vb5rZpWwe880cyP/V162w9Y7pb5JDhHmQU3Y14XcvOMpGu97CdOme/OgjxYS7h50kLQ5CjFaEfYNNgCj916KFpwSLcw0EQvRAy5ZVtoyh/lCurZF6kVwAxF84q8IWG0e8YhZDZyE+BkrVAGhGS07I2Za5WfecwVFOzS6dkR0Upu0lbkAtuRfhtEAJBp5sj83u3nelcVO1i6MdQeduCs34eLOG1da7hoCO3dprdFdVoDBrFph4mUDz1H7vuE/2jFUQjz7p7Qjf6B0aIQc2aviQ1Dd+POBaX2HvV/Q74zJt1kX2tI1hd0fMgiusJiUA4Ipw6AWIjHbV8L67FK/3wU8OeNHRl3BHqlGHtzF3WeDnlJz6AlblFxVVp1QnNe25I5by2vcpAjcdiS00I6dw8kWcNMEu3eNEuhgAOgzTGIJg0HIwfETGG/0qK9CwYFslq0q8fiO076oF54p8utM4jFgLb4Hxjs51FC7MSu4oK74dMlIxTzdyCR03ZS0gSoynf5Ehg3jI8Q4V6ZhpL3g7PapJuxiwcwjD14=
before_install:
- openssl aes-256-cbc -K $encrypted_147aa2f05e43_key -iv $encrypted_147aa2f05e43_iv
  -in secrets.tar.enc -out secrets.tar -d
- tar xvf secrets.tar
- mv google_compute_engine /home/travis/.ssh/
- chmod 0600 /home/travis/.ssh/google_compute_engine
script:
- molecule create --scenario-name ci-tests
- molecule converge --scenario-name ci-tests
- molecule verify --scenario-name ci-tests
after_script:
- molecule destroy --scenario-name ci-tests
